var myApp=angular.module("instApp",[]).config(function(o){o.when("/search/",{templateUrl:"../templates/search.html",controller:"Search"}).when("/profile/:id",{templateUrl:"../templates/profile.html",controller:"Profile"}).when("/profile/:id/followers/",{templateUrl:"../templates/followers.html",controller:"Followers"}).when("/profile/:id/follows/",{templateUrl:"../templates/follows.html",controller:"follows"}).when("/",{templateUrl:"../templates/timeline.html",controller:"Timeline"}).when("/about/",{templateUrl:"../templates/about.html"})}).controller("Profile",function(o,e,t){o.token=localStorage.getItem("accessToken"),o.userId=localStorage.getItem("userId"),t.id||(t.id=o.userId),e.jsonp("https://api.instagram.com/v1/users/"+t.id+"?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.user=e.data}),o.followMe=function(){e({method:"POST",params:{action:"follow"},url:"https://api.instagram.com/v1/users/199021565/relationship?&access_token="+o.token+"&callback=JSON_CALLBACK"}).success(function(o){console.log(o)})}}).controller("Search",function(o,e){e.jsonp("https://api.instagram.com/v1/media/popular/?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.searchPhotos=e,o.searchTimeline=o.searchPhotos.data}),o.search=function(){e.jsonp("https://api.instagram.com/v1/tags/"+o.hashtag+"/media/recent?&access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.searchPhotos=e,o.searchTimeline=o.searchPhotos.data})},o.$watch("hashtag",function(){o.hashtag=o.hashtag.replace(/\s+/g,"")})}).controller("Timeline",function(o,e){e.jsonp("https://api.instagram.com/v1/users/self/feed?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.pictures=e,o.timeline=o.pictures.data}),myApp.loadOnScroll(o,e,"pictures","timeline")}).controller("Followers",function(o,e,t){e.jsonp("https://api.instagram.com/v1/users/"+t.id+"/"+"followed-by"+"?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.followersData=e,o.followers=e.data}),myApp.loadOnScroll(o,e,"followersData","followers")}).controller("follows",function(o,e,t){e.jsonp("https://api.instagram.com/v1/users/"+t.id+"/"+"follows"+"?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.followersData=e,o.followers=e.data}),myApp.loadOnScroll(o,e,"followersData","followers")}).controller("GetProfilePhotos",function(o,e,t){t.id||(t.id=o.userId),e.jsonp("https://api.instagram.com/v1/users/"+t.id+"/media/recent?access_token="+o.token+"&callback=JSON_CALLBACK").success(function(e){o.userPhotoData=e,o.userPhotos=o.userPhotoData.data}),myApp.loadOnScroll(o,e,"userPhotoData","userPhotos")});myApp.loadOnScroll=function(o,e,t,l){var s=0;window.addEventListener("scroll",function(){var a=document.body,n=a.scrollTop;n>s&&n>=a.scrollHeight-window.innerHeight-50&&e.jsonp(o[t].pagination.next_url+"&callback=JSON_CALLBACK").success(function(e){o[t]=e,o[l]=o[l].concat(o[t].data)}),s=n})};